---
title: "Reproducible Research: Peer Assessment 1"
author: "Philip Chase"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The source data is available from https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip The zip file has been included in this repository for you convenience.

To use the data, unzip the provided file and load the data into a dataframe.

```{r}
echo=TRUE
unzip("activity.zip")
activityData <- read.csv("activity.csv")
```

Inspect the data to determine if it loaded correctly

```{r}
str(activityData)
```

read.csv interpreted the dates as factors.  That might not be the most useful data format.  To fix this re-read the data specifying the datatypes for each column.  Then convert the 'date' character string to a POSIXct date.

Also make sure NAs are handled correctly.  In this data they appear as the string "NA".

```{r}
library(lubridate)
colClasses <- c("integer", "character", "integer")
activityData <- read.csv("activity.csv", colClasses=colClasses, na.strings="NA")
activityData$date <- ymd(activityData$date)
str(activityData)
```

## What is mean total number of steps taken per day?

To determine the mean total number of steps per day, first sum the steps taken each day.  

```{r, message=FALSE}
library(dplyr)
total_steps_by_date <- activityData %>% group_by(date) %>% summarise(total_steps=sum(steps, na.rm=TRUE))
```

````{r echo=FALSE,hide=TRUE}
mean_steps <- round(mean(total_steps_by_date$total_steps))
median_steps <- median(total_steps_by_date$total_steps)
```

The histogram below shows the distribution of steps made in a day.  The mean value, `r mean_steps`, is represented by the green line while the median value, `r median_steps`, is represented by the blue line.

```{r}
library(ggplot2)

ggplot(data=total_steps_by_date, aes(x=total_steps)) + 
  geom_histogram(binwidth=diff(range(total_steps_by_date$total_steps))/10, fill="grey") +
  labs(title="Distribution of Daily Step Count in Human Activity Data") +
  xlab("Total steps per day") +
  ylab("Count") +
  geom_vline(xintercept = mean(total_steps_by_date$total_steps), colour="green")   +
  geom_vline(xintercept = median(total_steps_by_date$total_steps), colour="blue")
```


## What is the average daily activity pattern?

A daily pattern of activity can be determined by grouping the data by the daily time intervals

To determine the mean total number of steps per day, first sum the steps taken each day.  As NA values appear in every time interval at some point in the data they must be removed to get the sum of the steps in each interval.

```{r, message=FALSE}
library(dplyr)
average_steps_by_interval <- activityData %>% group_by(interval) %>% summarise(average_steps=mean(steps, na.rm=TRUE))
summary(average_steps_by_interval)
str(average_steps_by_interval)
```

They daily activity can be represented with histogram of step count in each interval

```{r}
library(ggplot2)

qplot(interval, average_steps, data=average_steps_by_interval) +
  geom_smooth(stat='smooth')

```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
